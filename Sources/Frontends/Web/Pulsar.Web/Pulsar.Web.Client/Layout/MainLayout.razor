@inherits LayoutComponentBase
@inject NavigationManager NavigationManager

<AuthorizeView>
    <Authorized>
        <FluentLayout>
            <FluentHeader>
                <img src="icons/logo-svg.svg" alt="Pulsar Logo" style="height: 30px; margin-right: 15px;" />
                <FluentBadge Fill="somevalue" BackgroundColor="#FFFFFF" Color="#000000" Height="25px">
                    <span style="padding-left: 10px; padding-right: 10px;">
                        USF ONESIA BENEDITA MIGUEL
                    </span>
                </FluentBadge>
                <div style="flex-grow: 1;"></div>
                <FluentCounterBadge Count="100" BackgroundColor="@Color.Error" Color="Color.Fill">
                    <FluentButton BackgroundColor="rgba(0, 0, 0, 0)">
                        <FluentIcon Value="@(new Icons.Regular.Size24.Alert())" Color="@Color.Fill" />
                    </FluentButton>
                </FluentCounterBadge>
                <FluentSpacer Width="18" />
                <FluentProfileMenu Status="@null"
                                   HeaderLabel="USF ONESIA BENEDITA MIGUEL"
                                   Initials="DS"
                                   FullName="@context.User.Identity!.Name"
                                   EMail="danskcarvalho@gmail.com"
                                   PopoverStyle="min-width: 330px;"
                                   HeaderButton="Sair"
                                   OnHeaderButtonClick="@(() => LogOff(context))"
                                   FooterLink="Configurações" />
            </FluentHeader>
            <FluentStack Class="main" Orientation="Orientation.Horizontal" Width="100%">
                <NavMenu />
                <FluentBodyContent Class="body-content">
                    <div class="content">
                        <FluentMessageBarProvider Section="MESSAGES_TOP"></FluentMessageBarProvider>
                        @Body
                    </div>
                </FluentBodyContent>
                <FluentDialogProvider />
                <FluentToastProvider MaxToastCount="10" />
            </FluentStack>
            <FluentFooter>
                <span>&#xA9; Pulsar 2024</span>
                <FluentSpacer />
                <a href="https://google.com" target="_blank">Ajuda</a>
            </FluentFooter>
        </FluentLayout>
    </Authorized>
    <NotAuthorized>

    </NotAuthorized>
</AuthorizeView>


<div id="blazor-error-ui">
    An unhandled error has occurred.
    <a href="" class="reload">Reload</a>
    <a class="dismiss">🗙</a>
</div>

@code {
    private void LogOff(AuthenticationState state)
    {
        NavigationManager.NavigateTo(state.User.FindFirst("bff:logout_url")?.Value!, forceLoad: true);
    }
}    